// <auto-generated>
// This code was generated by GodotApplePlugins.Generator.
// Do not edit this file directly. Edit the generator instead.
// </auto-generated>

#nullable enable

using Godot;
using System;
using System.Linq;
using System.Threading.Tasks;

namespace GodotApplePlugins.NET.Authentication;

/// <summary>
/// Manages authorization requests for Apple ID and other services.
/// </summary>
public partial class ASAuthorizationController : GodotObject
{
    #region StringName Constants

    private static readonly StringName _methodSignin = "signin";
    private static readonly StringName _methodSigninWithScopes = "signin_with_scopes";
    private static readonly StringName _signalAuthorizationCompleted = "authorization_completed";
    private static readonly StringName _signalAuthorizationFailed = "authorization_failed";

    #endregion

    private readonly GodotObject _instance;

    /// <summary>
    /// Creates a new ASAuthorizationController wrapper.
    /// </summary>
    public ASAuthorizationController(GodotObject instance)
    {
        _instance = instance ?? throw new ArgumentNullException(nameof(instance));
        ConnectSignals();
    }

    /// <summary>
    /// Gets the underlying GDExtension object.
    /// </summary>
    public GodotObject Instance => _instance;

    /// <summary>
    /// Call this method to initiate the signin with Apple workflow with the default scopes ('email', 'full_name'), this will raise the signal authorization_completed upon success, or the authorization_failed on failure.
    /// </summary>
    public void Signin()
    {
        _instance.Call(_methodSignin);
    }

    /// <summary>
    /// Call this method to initiate the signin with Apple workflow with a specific set of scopes, currently they can be any of 'email' and 'full_name'. This will raise the event authorization_completed upon success, or the authorization_failed on failure.
    /// </summary>
    public void SigninWithScopes(Godot.Collections.Array scopestrings)
    {
        _instance.Call(_methodSigninWithScopes, scopestrings);
    }

    #region Signals

    /// <summary>
    /// Emitted when the authorization request completes successfully. credential is usually an ASAuthorizationAppleIDCredential or ASPasswordCredential. It can be null if the credential type is unsupported.
    /// </summary>
    [Signal]
    public delegate void AuthorizationCompletedEventHandler(GodotObject credential);

    /// <summary>
    /// Emitted when the authorization request fails. error contains the localized description of the error.
    /// </summary>
    [Signal]
    public delegate void AuthorizationFailedEventHandler(string message);

    private void ConnectSignals()
    {
        _instance.Connect(_signalAuthorizationCompleted,
            Callable.From<GodotObject>((p0) =>
                EmitSignal(SignalName.AuthorizationCompleted, p0)));

        _instance.Connect(_signalAuthorizationFailed,
            Callable.From<string>((p0) =>
                EmitSignal(SignalName.AuthorizationFailed, p0)));

    }

    #endregion
}
